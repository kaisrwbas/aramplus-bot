- name: Show current aramplus.py
  run: cat aramplus.py

- name: Clear any stale files
  run: rm -f signal.txt price.txt || true
  
name: ğŸ“ˆ Daily AramPlus Signal
on:
  schedule:
    - cron: '0 0 * * *'  # Runs daily at 00:00 UTC
  workflow_dispatch:     # Allows manual run

jobs:
  signal:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
      - run: pip install -r requirements.txt
      - name: Run AramPlus
        run: python aramplus.py
      - name: Send Telegram Signal
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          SIGNAL=$(cat signal.txt)
          PRICE=$(cat price.txt)
          if [ "$SIGNAL" = "BUY" ]; then
            MSG="ğŸ”” *AramPlus Alert*%0AğŸ“ˆ BTC/USD: \$${PRICE}%0AğŸ¯ Signal: BUY%0AğŸ›¡ï¸ SL: -5% | TP: +10%"
          else
            MSG="âšª *AramPlus Update*%0AğŸ“‰ BTC/USD: \$${PRICE}%0Aâ¸ Signal: HOLD"
          fi
          curl -s "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" \
            -d "chat_id=${CHAT_ID}&text=${MSG}&parse_mode=Markdown"
